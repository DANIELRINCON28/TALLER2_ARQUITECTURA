<!-- 
  Formulario de creaci贸n de pedidos.
  Traducci贸n directa de order_create.php manteniendo la misma estructura y funcionalidad.
-->
{% extends 'orders/base.html' %}

{% block content %}
<!-- Equivalente a: <h1 class="h">Confirmaci贸n de Pedido</h1> -->
<h1 class="h">Confirmaci贸n de Pedido</h1>

<!-- 
  Equivalente a: <form method="post" action="?r=order/create" class="form">
  En Django se usa {% csrf_token %} para protecci贸n CSRF 
-->
<form method="post" action="{% url 'order_create' %}" class="form">
  {% csrf_token %}
  <!-- Equivalente a: <input type="hidden" name="__action" value="order.store"> -->
  <input type="hidden" name="__action" value="order.store">
  
  <div class="grid2">
    <!-- Equivalente a: <label class="field"><span>Email del cliente</span><input type="email" name="customer_email" required></label> -->
    <label class="field">
      <span>Email del cliente</span>
      <input type="email" name="customer_email" required>
    </label>
    
    <!-- Equivalente a: <label class="field"><span>Direcci贸n de entrega</span><input type="text" name="address" required></label> -->
    <label class="field">
      <span>Direcci贸n de entrega</span>
      <input type="text" name="address" required>
    </label>
  </div>
  
  <div class="grid2">
    <!-- Equivalente a: <label class="field"><span>Prioridad</span><select name="priority">... -->
    <label class="field">
      <span>Prioridad</span>
      <select name="priority">
        <option value="normal">Normal</option>
        <option value="express">Express</option>
      </select>
    </label>
    
    <!-- 
      Equivalente a: 
      <label class="field"><span>Fragilidad</span><select name="fragility">
      <?php foreach ($opts as $o): ?><option value="<?= $o ?>"><?= ucfirst($o) ?></option><?php endforeach; ?>
    -->
    <label class="field">
      <span>Fragilidad</span>
      <select name="fragility">
        {% for option in fragility_options %}
          <option value="{{ option }}">{{ option|title }}</option>
        {% endfor %}
      </select>
    </label>
  </div>

  <!-- NUEVA SECCIN: Selecci贸n de Estrategia de Patrones -->
  <div class="field mt">
    <span> Estrategia de Selecci贸n de Proveedor</span>
    <select name="strategy">
      <option value="standard"> Est谩ndar - Balance velocidad/costo</option>
      <option value="eco"> Ecol贸gica - Menor impacto ambiental</option>
      <option value="cost"> Optimizada por costo - M谩s econ贸mica</option>
    </select>
    <small class="muted">Selecciona qu茅 patr贸n Strategy usar para elegir el proveedor de entrega</small>
  </div>
  
  <!-- Equivalente a: <h2 class="hh mt">Items</h2> -->
  <h2 class="hh mt">Items</h2>
  <p class="muted">Selecciona cantidades (0 para omitir).</p>
  
  <!-- 
    Equivalente a: 
    <?php foreach ($products as $p): ?>
      <label class="field-inline">
        <span><?= htmlspecialchars($p['name']) ?> (<?= (int)$p['weight_grams'] ?> g)</span>
        <input class="qty" type="number" name="items[<?= (int)$p['id'] ?>]" min="0" max="20" value="0">
      </label>
    <?php endforeach; ?>
  -->
  {% for product in products %}
    <label class="field-inline">
      <span>{{ product.name }} ({{ product.weight_grams }} g)</span>
      <input class="qty" type="number" name="items[{{ product.id }}]" min="0" max="20" value="0">
    </label>
  {% endfor %}
  
  <!-- Equivalente a las acciones del formulario en PHP -->
  <div class="actions mt">
    <button class="btn primary">Confirmar y despachar</button>
    <a class="btn" href="{% url 'home' %}">Cancelar</a>
  </div>
</form>

<!-- Informaci贸n sobre patrones implementados -->
<div class="note">
  <h3> Patrones de Dise帽o Implementados:</h3>
  <ul>
    <li><strong> Builder (Creacional):</strong> Construcci贸n compleja del pedido con validaciones</li>
    <li><strong> Adapter (Estructural):</strong> Integraci贸n unificada con APIs de proveedores</li>
    <li><strong> Strategy (Comportamental):</strong> Selecci贸n inteligente de proveedores</li>
    <li><strong> Observer (Comportamental):</strong> Sistema de notificaciones autom谩ticas</li>
  </ul>
  <p><em>Al confirmar el pedido, se ejecutar谩 el flujo completo con todos los patrones.</em></p>
</div>
{% endblock %}